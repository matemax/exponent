\documentclass[16pt]{article}

%----------------------------------------------------------------------
% Layout scope begin
%----------------------------------------------------------------------

\evensidemargin=-1cm \oddsidemargin=-1cm \textwidth=18cm
\topmargin=-2cm \textheight=24cm % У тебя была слишком большая высота текста. Настолько большая, что не влезала нумерация страниц, да что уж там, даже текст не умещался на страницу. Вообще поменьше редактируй вывод на страницу, особенно до завершения идейной части
\renewcommand{\baselinestretch}{1.01}
\parskip=3mm

%----------------------------------------------------------------------
% Layout scope end
%----------------------------------------------------------------------

%----------------------------------------------------------------------
% Usepackage scope begin
%----------------------------------------------------------------------

\usepackage[dvipsnames]{xcolor}% я добавил пакет с цветами для текста
\usepackage[T2A]{fontenc}
\usepackage{amsfonts, amsmath, amsthm, amssymb}
\usepackage{mathtext}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

%----------------------------------------------------------------------
% Usepackage scope end
%----------------------------------------------------------------------

%----------------------------------------------------------------------
% Newcommand scope begin
%----------------------------------------------------------------------


% Я добавил цвета, чтобы различать комментарии от текста
\newcommand{\red}[1]{{\color{red}#1}}
\newcommand{\blue}[1]{{\color{blue}#1}}
\newcommand{\green}[1]{{\color{OliveGreen}#1}}
\newcommand{\orange}[1]{{\color{orange}#1}}


\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator*{\opluqs}{\oplus}





\renewcommand{\le}{\leqslant} % Не очень это культурно переопределять общеиспользуемые команды
\renewcommand{\ge}{\geqslant} % Вообще по возможности переопределяй как можно меньше


%----------------------------------------------------------------------
% Newcommand scope end
%----------------------------------------------------------------------


%----------------------------------------------------------------------
% Theorem scopes begin
%----------------------------------------------------------------------
% Всегда используй полные имена окружений, иначе это не возможно читать
% Все объявления делай до начала документа
% Со звездочкой - не нумеруются.
% [theorem] -- означает, что нумерация будет сплошная по счетчику от окружения theorem

% Стиль для теорем. Заголовок жирным, текст курсивом.
\theoremstyle{plain1}
\newtheorem{theorem1}{Теорема}
\newtheorem{lemma}[theorem1]{Лемма}
\theoremstyle{plain2}
\newtheorem{theorem2}{Теорема}
\theoremstyle{plain}
\newtheorem{theorem}{Теорема}
\theoremstyle{plain3}
\newtheorem{theorem3}{Теорема}
\newtheorem{proposition}[theorem1]{Предложение}
\newtheorem{corollary}[theorem1]{Следствие}
\newtheorem*{theorem*}{Теорема}
\newtheorem*{lemma*}{Лемма}
\newtheorem*{proposition*}{Предложение}
\newtheorem*{corollary*}{Следствие}

% Стиль для определений. Заголовок жирным, текст обычным.
\theoremstyle{definition}
\newtheorem{definition}[theorem2]{Определение}
\newtheorem{example}[theorem3]{Пример}
\newtheorem*{definition*}{Определение}
\newtheorem*{example*}{Пример}

% Стиль для замечаний. Заголовок курсивом, текст обычным.
\theoremstyle{remark}
\newtheorem{remark}[theorem1]{Замечание}

\newtheorem*{remark*}{Замечание}


%----------------------------------------------------------------------
% Theorem scope end
%----------------------------------------------------------------------


%----------------------------------------------------------------------
% Frontmatter scope begin
%----------------------------------------------------------------------



%----------------------------------------------------------------------
% Frontmatter scope end
%----------------------------------------------------------------------

\begin{document}
\section{Введение}

Теория диффернциальных многочленов была основана в 30-е года  двадцатого века Джозефом Риттом и Эллисом Колчином. В одной из своих ранних работ в своей статье <<On the exponents of Differential Ideals>>\cite{E. R. Kolchin} Эллис Колчин ввёл понятие экспоненты дифференциального идеал $I$, минимального числа $m$, такого что $\sqrt{I}^m\subseteq I$. Он рассматривал случай идеала, порождённого многочленом порядка не выше два. В статье были разобраны несколько достаточно общих случаев (но не все), в этих случаях было установлено, что экспонента может равняться 1, 2 или бесконечности.  Основная работа была проделана в так называемом сингулярном случае, $[f,S_f]\ne(1)$ где $S_f$~--- сепаранта многочлена $f$ (все определения даны ниже). В случае отсутствия сингулярного решения Колчин  установил, что если в добавок многочлен удовлетворяет условию $[f]+(S_f)=(1)$, то экспонента идеала, порождённого им равна 1, т.е. идеал $[f]$ является радикальным (здесь Колчин не опирался на ограничение пна порядок многочлена).

В 2007 году Дмитрий Трушин в~\cite{Trushin} доказал, что при условии $[f,S_f]=1$, наличие в идеале квазилинейного многочлена равносильно выполнению условия $[f]+(S_f)=(1)$. Как мы видим, в обоих случаях возникает одно и тоже условие на многочлен $f$.   Но в обоих работах не было сказано как алгоритмически проверять равенство  $[f]+(S_f)=(1)$ при условии  $[f,S_f]=(1)$. Условие $[f,S_f]=(1)$ мы можем проверить с помощью алгоритма Розенфельда-Грёбнера. Но со вторым условием возникает сложность, так как идеал $[f]+(S_f)$ не является дифференциальным и бесконечно порождён. Целью данной работы является разработка  алгоритма, который разделяет эти два случая.

\section{Основные понятия, определения, обозначения}
Дадим несколько необходимых определений и обозначений. Мы будем считать, что мы работаем над алгебраически замкнутым полем ${K}$ нулевой характеристики, которое имеет более чем счётную мощность. Над этим полем зададим тождественно нулевое дифференцирование (см.~определение ниже).

\begin{definition}
Кольцо $\mathcal{R}$ называется \emph{алгеброй Ритта}, если оно является алгеброй над~$\mathbb{Q}$.
\end{definition}

\begin{definition}
Отображение $\delta: \mathcal{R} \to \mathcal{R}$ называется \emph{дифференцированием}, если для любых элементов $a$ и $b$ кольца $\mathcal{R}$
выполнены следующие свойства:
\begin{enumerate}
  \item $\delta(a+b)= \delta(a)+\delta(b)$~--– линейность;
  \item $\delta(ab)=a\delta(b)+b\delta(a)$~--- правило Лейбница.
\end{enumerate}
\end{definition}

\begin{definition}
Кольцо $\mathcal{R}$ называется \emph{обыкновенным дифференциальным кольцом}, если на нем задано одно дифференцирование.
\end{definition}

\begin{definition}
Пусть $K$~--- обыкновенное дифференциальное поле.
\emph{Кольцом дифференциальных многочленов} от одной неизвестной над $K$
называется кольцо многочленов от счетного числа переменных ${K}[y_0,\ldots,y_n,\ldots]$
(обозначается ${K}\{y\}$)
с дифференцированием $\delta$, таким, что $\delta(y_i)=y_{i+1}$ и $\delta$, ограниченное на ${K}$, совпадает с дифференцированием поля $K$. Дифференцирование $\delta$, заданное таким способом, однозначно продолжается на $K\{y\}$ по линейности и правилу Лейбница.
\end{definition}

В дальнейшем для удобства мы будем обозначать $n$-ю производную многочлена $f$ как $\delta^n(f)=f^{(n)}$. Также нам потребуется понятие порядка многочлена и сепаранты.
\begin{definition}
Пусть $M = \prod\limits_{i=0}^ny_i^{a_i}$, где $a_i \ge 0$, причем $a_n > 0$. Тогда $n$ называется \emph{порядком} монома $M$ (обозначение: $\ord M=n$). Соответственно, порядком многочлена называется максимальный порядок
мономов, его составляющих.
\end{definition}
\begin{definition}
Будем говорить, что переменная $y_i$ старше переменной $y_j$ (обозначение: $y_i \succ y_j$), если $i>j$.
\end{definition}
\begin{definition}
\emph{Дифференциальным идеалом} дифференциального кольца $\mathcal{R}$ называется идеал $a$ такой, что $\delta(a)\subseteq a$.
\end{definition}


\begin{definition}
Для элемента $f$ кольца $\mathbb{K}\{y\}$ определим \emph{сепаранту} $S_f$
как частную производную по старшей переменной. Для элементов поля полагаем ее нулем.
\end{definition}

\begin{definition} Многочлен называется \emph{квазилинейным}, если
его сепаранта принадлежит полю $K$.
\end{definition}



Будем обозначать скобками <<()>>,<<$[~]$>>,<<$\{\}$>> соответственно
алгебраический, дифференциальный, радикальный дифференциальный
идеалы, порождённые элементами, заключенными внутри скобок.


\begin{definition}
Пусть $f_1,\ldots,f_n\in K\{y\}$ --- некоторый набор
дифференциальных многочленов. Тогда \emph{формальным решением}
системы дифференциальных уравнений $f_1=\ldots =f_n=0$ называется
элемент $t\in K^{\mathbb{N}}= K^{\infty}$, такой, что $ (\theta f_i)(t)=0$ для
любого $i$ и любого $\theta\in\Theta$ (подстановка значений в
многочлен осуществляется по правилу $\forall j\ge 0 \, y_j:=t_j$).
\end{definition}




\begin{definition}
Пусть $f_1,\ldots,f_n\in K\{y\}$ --- некоторый
набор дифференциальных многочленов. Тогда \emph{дифференциальным
решением} системы дифференциальных уравнений $f_1=\ldots =f_n=0$
называется элемент $\xi \in \mathbb{F}$ некоторого дифференциального
поля $\mathbb{F}$, содержащего $K$, такой, что $ f_i(\xi)=0$ для
любого $i$.
\end{definition}

Пусть $\xi$~--- дифференциальное решение некоторой системы уравнений, принадлежащее~$K$.
Тогда $(\xi, \delta \xi, \delta^2 \xi, \ldots)$~--- формальное решение.

\begin{definition} \emph{Сингулярным корнем} многочлена $f$
называется дифференциальное решение системы $f=S_f=0$.
\end{definition}
\begin{example*}
Рассмотрим многочлен $f=y_0-\frac{y^2_1}{4}\in\mathbb{C}\{y\}$. Если рассматривать решения в поле частных кольца $\mathbb{C}[x]$ с естественным дифференцированием $(x^n)'=nx^{n-1}$, то многочлен $g=x^2$ очевидным образом будет являться  дифференциальным решением уравнения $f=0$, так как $x^2-((x^2)')^2/4=0$. Ещё одним дифференциальным решением будет $h=0$. Рассмотрим сепаранту нашего многочлена $S_f=-\frac{y_1}{2}$, тогда сингулярным корнем будет только второе решение $h=0$. Формальным решением уравнения $f=0$ над полем $\mathbb{C}$, например, будет $(2,2\sqrt{2},2,0,0,\ldots,0,\ldots)\in \mathbb{C}$. Для доказательство этого достаточно заметить, что начиная с $i=3$ каждый моном  многочлена $f^{(i)}$ будет зависеть от переменной, которая старше $y_2$, а следовательно при подстановке нашего решения занулится. Для первых трёх уравнений $f=f^{(1)}=f^{(2)}=0$ проверяется вручную.
\end{example*}
\begin{definition} Дифференциальное поле $\mathbb{F}$ называется
\emph{дифференциально замкнутым}, если для любой системы дифференциальных алгебраических
уравнений, которая имеет решение в некотором расширении поля $\mathbb{F}$,
имеется решение и в самом $\mathbb{F}$.
\end{definition}

Далее нам потребуется формулировка теоремы Гильберта о нулях для
различных колец многочленов.
В случае обычного кольца многочленов над алгебраически
замкнутым полем по теореме Гильберта о нулях
имеется взаимно однозначное соответствие между многообразиями и радикальными идеалами.
Аналогично, в случае дифференциально
замкнутого поля $\mathbb{F}$ и кольца $\mathbb{F}\{y\}$ многочлен $g$ лежит в
радикале $\{f\}$ тогда и только тогда, когда все дифференциальные
решения уравнения $f=0$ являются дифференциальным решениями уравнения $g=0$.

Пусть $\mathbb{F}$~--- дифференциально замкнутое поле характеристики~$0$,
$R=\mathbb{F}\{x_1,...,x_n\}$ ($x_1,...,x_n$~--- дифференциальные
переменные) и $A=\mathbb{F}^n$. Для произвольного множества
дифференциальных многочленов $E$ определим \emph{дифференциальное многообразие}
$$
\mathbf{V}(E)=\{a\in \mathbb{F}^n \mid f(a)=0\quad\forall  f\in E\}
$$
и для произвольного подмножества $Y$ в $\mathbb{F}^n$ положим
$$
\mathbf{I}(Y)=\{f \in R \mid f(Y)=0\}.
$$

\begin{theorem}[\bf Дифференциальная теорема Гильберта о нулях]\label{theorem:th 0 for dif}
Пусть $\mathbb{F}$ дифференциально замкнуто. Тогда для любого собственного дифференциального идеала $J$ в
$\mathbb{F}\{x_1,\ldots,x_n\}$ множество $\mathbf{V}(J)$ не пусто. \cite[Chapter~IV,
Section~2, Theorem~1]{Kolchin 2}
\end{theorem}

Пусть $\mathbb{F}$~--- произвольное поле, $\kappa$ --- фиксированный
бесконечный кардинал, а $X$~--- множество переменных мощности строго
меньшей, чем $\kappa$. Пусть $R=\mathbb{F}[X]$ и $A=\mathbb{F}^X$. Тогда многочлены из
$R$ можно рассматривать как функции из $A$ в $\mathbb{F}$. Так же как и для
дифференциальных идеалов, можно определить алгебраическое многообразие $$\mathbf{V}(E)=\{a\in A\,
\mid f(a)=0~\forall f\in E\}.$$ Для произвольного подмножества $Y$
в $A$ положим
$$
 \mathbf{I}(Y)=\{f \in R\, \mid f(Y)=0\}.
$$

\begin{theorem}\label{theorem:th 0 for alg}
В указанных выше условиях следующие три пункта эквивалентны:

\begin{enumerate}
\item Поле $\mathbb{F}$ алгебраически замкнуто и $|\mathbb{F}|>\kappa$.

\item Для любого собственного идеала $J$ в $\mathbb{F}[X]$ множество
$\mathbf{V}(J)$ непусто.

\item Для любого идеала $J$ в $\mathbb{F}[X]$ имеет место равенство
$\sqrt{(J)}=\mathbf{I}(\mathbf{V}(X))$, где $\sqrt{J}$~--- радикал~$J$.
\end{enumerate}
\cite[Section~1, Theorem]{Lang}
\end{theorem}

В дальнейшем в роли $X$ у нас будет выступать счётный набор
переменных, а в роли $\kappa$~--- мощность дифференциального идеала
в кольце дифференциальных многочленов
над алгебраически замкнутым полем, т.~е. мощность $\kappa$
окажется более чем счётной.


\begin{definition} Размерностью неприводимого алгебраического многообразия
${V}={V}_0\subseteq K^n$ называется длина максимальной цепочки
${V}_k\subset\ldots{V}_1\subset{V}_0$, где
${V}_i\subseteq K^n$ является собственным неприводимым алгебраическим подмногообразием
в ${V}_{i-1}$.
\end{definition}

\begin{definition}
Пусть $x\in K^{\infty}$. Тогда $\Pi_m(x):=x'\in K^{m+1}$ назовём \emph{проекцией}
точки $x$ на первые $m+1$ координату (которые соответствуют у нас
переменным $y_0,\ldots y_m$). Проекцией множества точек будем называть объединение проекций всех точек этого множества.
\end{definition}


\section{Вспомогательные леммы}

Далее мы будем использовать букву $n$ для обозначения порядка дифференцирования и $l$ для порядка многочлена.


\begin{lemma}\label{lemma:der_monom}
Пусть моном $M$ записан в виде $M=y_{r_1}\ldots y_{r_d}$. Тогда
$$
M^{(n)} =\sum\limits_{\stackrel{s_i\ge0,}{
s_1+\ldots+s_d=n}}\frac{n!}{s_1!\ldots s_d!}
\prod\limits_{i=1}^dy_{r_i+s_i}.
$$
\end{lemma}
\begin{proof}
Следует непосредственно из правила Лейбница.
\end{proof}


\begin{lemma}\label{lemma:commutative derivatives}
Пусть $f$~--- дифференциальный многочлен. Тогда для любого $s\in\mathbb{N}$ 
$$
\frac{\partial f^{(1)}}{\partial y_s}=\left(\frac{\partial f}{\partial y_s}\right)^{(1)}+\frac{\partial f}{\partial y_{s-1}},
$$
где $\frac{\partial}{\partial y_s}$~--- обычная частная производная.
\end{lemma}
\begin{proof}
Пусть $l=\ord f$. Воспользуемся формулой $f^{(1)}=\sum\limits_{i=0}^l\frac{\partial f}{\partial y_i}y_{i+1}$, которая следует из правила Лейбница. Имеем 
$$
\frac{\partial f^{(1)}}{\partial y_s}=\frac{\partial\left(\sum\limits_{i=0}^l\frac{\partial f}{\partial y_i}y_{i+1}\right)}{\partial y_s}=\sum\limits_{i=0}^l\frac{\partial \frac{\partial f}{\partial y_i} }{\partial y_s}y_{i+1}+\sum\limits_{i=0}^l\frac{\partial y_{i+1}}{\partial y_s}\frac{\partial f}{\partial y_i}.
$$
Во второй сумме только слагаемое 
$\frac{\partial y_{s}}{\partial y_s}\frac{\partial f}{\partial y_{s-1}}=\frac{\partial f}{\partial y_{s-1}}$ 
не равно 0, т.~е. 
$$
\frac{\partial f^{(1)}}{\partial y_s}=\sum\limits_{i=0}^l\frac{\partial \frac{\partial f}{\partial y_i}}{\partial y_s}y_{i+1}+\frac{\partial f}{\partial y_{s-1}}=\sum\limits_{i=0}^l\frac{\partial \frac{\partial f}{\partial y_s}}{\partial y_i}y_{i+1}+\frac{\partial f}{\partial y_{s-1}}=\left(\frac{\partial f}{\partial y_s}\right)^{(1)}+\frac{\partial f}{\partial y_{s-1}}.
$$
\end{proof}

\begin{lemma}\label{lemma:f^(n)}
Пусть $f$~--- дифференциальный многочлен. Тогда для любых $n, s \in\mathbb{N}$ верно
$$
\frac{\partial f^{(n)}}{\partial y_s} = \sum\limits_{i=0}^n  C_n^i  \left(\frac{\partial f}{\partial y_{i+s-n}}\right)^{(i)}.
$$
\end{lemma}
\begin{proof}
Докажем это утверждение индукцией по $n$.  База ($n=1$) верна по лемме~\ref{lemma:commutative derivatives}. Предположим, что для $n=k$ утверждение верно.
Докажем, что утверждение верно при $n=k+1$. Пусть $f^{(1)}=g$. Тогда
$\frac{\partial f^{(k+1)}}{\partial y_s} = \frac{\partial g^{(k)}}{\partial y_s}$.
Применим предположение индукции к многочлену $g^{(k)}$. Имеем 
$$
\frac{\partial f^{(k+1)}}{\partial y_s} =  \sum\limits_{i=0}^k  C_k^i  \left(\frac{\partial g}{\partial y_{i+s-k}}\right)^{(i)}=\sum\limits_{i=0}^k  C_k^i  \left(\frac{\partial f^{(1)}}{\partial y_{i+s-k}}\right)^{(i)}. 
$$
Воспользуемся линейностью дифференцировния и леммой~\ref{lemma:commutative derivatives} в каждом слагаемом в последней сумме:  
$$
\left(\frac{\partial f^{(1)}}{\partial y_{i+s-k}}\right)^{(i)}= \left(\frac{\partial f}{\partial y_{i+s-k-1}}+\left(\frac{\partial f}{\partial y_{i+s-k}}\right)^{(1)}\right)^{(i)}=\left(\frac{\partial f}{\partial y_{i+s-k-1}}\right)^{(i)}+\left(\frac{\partial f}{\partial y_{i+s-k}}\right)^{(i+1)}.
$$ 
Следовательно,
\begin{gather*}
\frac{\partial f^{(k+1)}}{\partial y_s}=\sum\limits_{i=0}^k  C_k^i\left(\frac{\partial f}{\partial y_{(i+s-k)-1}}\right)^{(i)}+\sum\limits_{i=0}^k  C_k^i\left(\frac{\partial f}{\partial y_{i+s-k}}\right)^{(i+1)} = \\
= \sum\limits_{i=0}^k  C_k^i\left(\frac{\partial f}{\partial y_{(i+s-k)-1}}\right)^{(i)}+\sum\limits_{i=1}^{k+1}  C_k^{i-1}\left(\frac{\partial f}{\partial y_{i+s-k-1}}\right)^{(i)}=\sum\limits_{i=1}^{k+1} C_{k+1}^{i}\left(\frac{\partial f}{\partial y_{i+s-(k+1)}}\right)^{(i)}
\end{gather*}
Переход доказан.
\end{proof}
Рассмотрим дифференциальный многочлен $g$ порядка $l$ и произвольное
целое число $k\ge0$. Представим многочлен в виде $g=g_0+A_{g,k}y_k$, где
$g_0$ не зависит от $y_k$, а многочлен $y_kA_{g,k}$ получается из
многочлена $g$ нахождением всех мономов, зависящих от $y_k$, и
вынесением этой переменной за скобки.
\begin{lemma}\label{lemma:A_fn}
Пусть $f$~--- дифференциальный многочлен и $\ord f = l$.
Тогда для любых $k$ и $n$ с условием  $n\in\mathbb{N},0\le k\in\mathbb{Z}$, $n>2k$ верно следующее
равенство:
$$
A_{f^{(n)}, n+l-k}=\sum\limits_{j=0}^{l}C_n^{k - l + j
}\left(\frac{\partial f}{\partial y_j}\right)^{(k - l + j)}.
$$
Здесь мы по умолчанию понимаем $C_n^{k}=0$ для отрицательных
$k$.
\end{lemma}


\begin{proof}
Заметим, что в силу линейности дифференцирования мы можем считать
$f$ мономом. Пусть $\deg f = d$ и $f$ представляется в
виде
$$
f=\prod\limits_{i=0}^ly_i^{m_i}=\prod\limits_{i=1}^{d}y_{r_i},
$$
где $r_i\le r_j$ при $i \le j$. Тогда применив лемму~\ref{lemma:der_monom} к $f^{(n)}$,
получим
$$
f^{(n)}=\sum\limits_{\stackrel{s_i\ge0,}{
s_1+\ldots+s_d=n}}\frac{n!}{s_1!\ldots s_d!}
\prod\limits_{i=1}^dy_{r_i+s_i}.
$$
Так как $n>2k$, то в каждом мономе вида $\prod_{i=1}^d y_{r_i+s_i}$
переменная $y_{n+l-k}$ встречается единожды. Действительно, пусть
$y_{r_i+s_i}=y_{n+l-k}$ и $y_{r_j+s_j}=y_{n+l-k}$. Но тогда
$$
r_i+s_i+r_j+s_j = 2(n+l-k).
$$
Следовательно,
$$
2(n+l-k)\le 2r_d + \sum_{i=1}^d s_d = 2l +n.
$$
Значит, $n \le 2k$, что противоречит выбору $n>2k$. Мы получили, что многочлен $f^{(n)}$ линеен по всем переменным $y_{n+l-k},n>2k $. Пусть $f^{(n)}=f^{(n)}_0+A_{f^{(n)},n+l-k}y_{n+l-k}$. Тогда, в силу линейности $f^{(n)}$ по $y_{n+l-k}$,
$$
\frac{\partial f^{(n)}}{\partial y_{n+l-k}}=\frac{\partial (f^{(n)}_0+A_{f^{(n)},n+l-k}y_{n+l-k})}{\partial y_{n+l-k}}=A_{f^{(n)},n+l-k}.
$$

С другой стороны, по лемме~\ref{lemma:f^(n)} $\frac{\partial f^{(n)}}{\partial y_{n+l-k}}= \sum\limits_{i=0}^n  C_n^i  \left(\frac{\partial f}{\partial y_{i+l-k}}\right)^{(i)} $. Заметим, что так как $\ord f^{(n)} = l$, то для всех $i>k$ выполнено $\frac{\partial f}{\partial y_{i+l-k}}=0$. Отсюда следует, что 
\begin{gather*}
A_{f^{(n)},n+l-k}=\sum\limits_{i=0}^n  C_n^i  \left(\frac{\partial f}{\partial y_{i+l-k}}\right)^{(i)}=\sum\limits_{i=0}^k  C_n^i  \left(\frac{\partial f}{\partial y_{i+l-k}}\right)^{(i)}=\\
=\sum\limits_{j=l-k}^l  C_n^{k-l+j}  \left(\frac{\partial f}{\partial y_{j}}\right)^{(k-l+j)}=\sum\limits_{j=0}^{l}C_n^{k - l + j
}\left(\frac{\partial f}{\partial y_j}\right)^{(k - l + j)}.
\end{gather*}
Последнее равенство верно, так как если $l>k$, то из $0 \le j<l-k \Longrightarrow C_n^{k-l+j}=0$, а если $l<k$, то  $k-l\le j<0 \Longrightarrow \frac{\partial f}{\partial y_{j}}=0$. 
\end{proof}

\begin{corollary}\label{corollary:deriv_equal}
Пусть $f$~--- дифференциальный многочлен, $\ord f = l$ и $n\in\mathbb{N},0\le k\in\mathbb{Z}$, $n>2k$.
Тогда
\begin{enumerate}
\item $\ord A_{f^{(n)},n+l-k}\le k+l$.

\item Выполнено равенство
$$
f^{(n)}=\sum\limits_{i=0}^{k} A_{f^{(n)},n+l -i} \, y_{n+l-i} + Q,
$$
где $\ord Q < n+l-k$.
%В частности, по переменным $y_{n+l-k}, \ldots, y_{n+l}$ $n$-я производная дифференциального многочлена является линейной.
\end{enumerate}
\end{corollary}

\begin{proof} Первый пункт непосредственно следует из леммы~\ref{lemma:A_fn}.

Докажем индукцией по $m\le k$, что
$$
f^{(n)}=\sum\limits_{i=0}^{m} A_{f^{(n)},n+l -i} \, y_{n+l -i} + Q_m,
$$
где $\ord Q_m < n+l-m$. База ($m = 0$) выполнена:
$$
 f^{(n)}=S_fy_{n+l}+Q_0=A_{f^{(n)}, n + l} \, y_{n+l} +Q_0.
$$

Предположим, что для $m<k$ утверждение доказано. Докажем его для $m+1\le k$.
%По предположению имеем, что
%$$
%f^{(n)}=\sum\limits_{i=0}^{m} A_{f^{(n)},n+l -i}y_{n+l -i} + Q_m.
%$$
Рассмотрим слагаемые суммы
$$
 \sum\limits_{i=0}^{m} A_{f^{(n)},n+l -i} \, y_{n+l -i}.
$$
Из первого утверждения следует, что
$$
\ord A_{f^{(n)},n+l -i}\le l+i\le l+m.
$$
Так как $m+1 \le k < \frac{n}{2}$, то $l+m < n+l-(m+1)$, 
и среди слагаемых суммы переменная $y_{n+1-(m+1)}$ не встречается.
Следовательно,
$$
A_{f^{(n)}, n+l-(m+1)} = A_{Q_{m}, n+l-(m+1)}.
$$
Если переменная $y_{n+1-(m+1)}$ встречается в $Q_m$, то она является старшей.
Поэтому
$$
 Q_{m}=A_{Q_{m}, n+l-(m+1)}y_{n+l-(m+1)}+Q_{m+1}
$$
где $\ord Q_{m+1}<n+l-(m+1)$,
откуда
$$
f^{(n)}=\sum\limits_{i=0}^{m+1} A_{f^{(n)},n+l-i}y_{n+l-i} + Q_{m+1}.
$$
Переход доказан.
\end{proof}
\begin{definition}
Пусть $f\in\mathbf{K}\{y\},\ord f=l$  и $n\in\mathbb{N},0\le k\in\mathbb{Z}$, такие, что $n>2k$. \emph{Обобщёнными сепарантами} многочлена $f$ будем назвать многочлены $S_{f,n,k}=\sum\limits_{j=0}^{l}C_n^{k - l + j
}\left(\frac{\partial f}{\partial y_j}\right)^{(k - l + j)}$. В частности, при $k=0$ обобщённая сепаранта совпадает с обычной: $S_{f,n,0}=S_f = \frac{\partial f}{\partial y_l}$. 
\end{definition}
Из доказанного выше следует, что $f^{(n)}= \sum\limits_{i=0}^{k} S_{f,n,i} \, y_{n+l -i}+ Q$, где $2k<n\in\mathbb{N}\,,\ord Q < n+l-k$.

\bigskip

Следующий результат, по видимому, является известным, но мы не нашли
подходящей ссылки, и потому приводим его доказательство.

\begin{lemma} \label{lemma:sb_vr_cntm}
Пусть $X$~--- неприводимое многообразие размерности $n > 0$ над алгебраически замкнутым полем $K$
мощности не меньшей континуума. Тогда в
$X$ содержится как минимум континуальное множество
неприводимых подмногообразий размерности $n-1$.
\end{lemma}

\begin{proof}
Пусть $f$~--- некоторая
непостоянная функция на $X$. Тогда образ $f$ является
коконечным множеством, то есть, для любого $a\in K$, кроме конечного
числа, прообраз $f^{-1}(a)$ не пуст~\cite[глава 2, \S3, упр. 3.19]{Hartshorn}. С другой стороны,
этот прообраз задается уравнением $f-a$ в кольце $K[X]$
регулярных функций на $X$. Тогда по теореме Крулля о размерности~\cite[Chapter~5,
Section~12, Theorem~18]{Matsumura} все
компоненты подмногообразия, задаваемого уравнением $f-a=0$, имеют
коразмерность один. Так как $K$ без конечного числа точек тоже
имеет мощность не меньше континуума, то многообразий вида $f-a=0$ тоже по крайней мере континуум, а следовательно, их
неприводимых компонент также по крайней мере континуум.
\end{proof}

\begin{lemma} \label{lemma:o vlojenii}
Пусть у нас задано некоторое неприводимое многообразие
$U\subset K^n$ и счетное семейство многочленов
$g_i\in K[x_1,\ldots,x_n]$, $i \in \mathbb{N}$. Рассмотрим объединение
многообразий $V=\bigcup\limits
_{i=1}^{\infty}\mathbf{V}(g_i)$. Тогда либо
$\exists i:\: U \subset \mathbf{V}(g_i)$, либо
$U\nsubseteq V$.
\end{lemma}

\begin{proof}
От противного. Пусть $U\subset V$, но нет такого
$i$, что $U \subset \mathbf{V}(g_i)$.
Но
$$
U=\bigcup\limits_{i=1}^{\infty}\left(\mathbf{V}(g_i)\bigcap U\right).
$$
Размерность каждого подмногообразия
$\mathbf{V}(g_i)\bigcap U$ меньше
размерности $U$ в силу неприводимости~$U$.
Таким образом $U$ представляется в виде счётного объединения
подмногообразий меньшей размерности. 
Докажем индукцией
по размерности $\dim~U=n$,
что такое представление невозможно.

База ($n=1$). Утверждение очевидно, в силу того, что многообразия
нулевой размерности это точки, а мощность многообразия
размерности 1 континуальна по лемме~\ref{lemma:sb_vr_cntm}.

Шаг индукции. Пусть для некоторого $n$ мы доказали утверждение, докажем его для $n+1$.
Пусть $\mathcal M$~--- множество всех подмногообразий коразмерности
один многообразия $U$ и
$$
\mathcal M' = \{ U\cap \mathbf{V}(g_i)\mid i\in \mathbb N \}.
$$
По лемме~\ref{lemma:sb_vr_cntm} множество $\mathcal M$ несчетно, а
следовательно, $\mathcal M\setminus\mathcal M'\neq \varnothing$.
Пусть $Z$~--- элемент этой разности. Тогда $Z$ не принадлежит ни
одному из $\mathbf{V}(g_i)$, но покрывается их
объединением. Так как $\dim Z<\dim U$, получаем
противоречие с индукционным предположением.
\end{proof}

\bigskip

\begin{remark}\label{remark:o vlojenii}

Пусть $K$~--- алгебраически замкнутое поле континуальной
мощности, и пусть дан многочлен $ g(y_0,\ldots,y_k,x)\in
K[y_0,\ldots,y_k,x]$. Рассмотрим семейство многочленов
$$
g_n(y_0,\ldots,y_k) = g(y_0,\ldots,y_k,n) \in K[n][y_0,\ldots,y_k],\quad
n\in \mathbb N,
$$
полиномиально зависящих от параметра $n$.
Пусть $U\subseteq K^{k+1}$~--- некоторое неприводимое многообразие и
$I=\mathbf{I}(U)\triangleleft K[y_0,\ldots,y_k]$~---
соответствующий ему идеал.
Нас будет интересовать вопрос: выполняется ли вложение
$$
U\subseteq \bigcup_{n=0}^{\infty}\mathbf{V}(g_n),
$$
и если да, то при каких $n$ выполнено $U\subseteq \mathbf{V}(g_n)$?
(По лемме~\ref{lemma:o vlojenii} мы знаем, что если имеет место первое вложение, то такое $n$ существует.)

Зафиксируем в $K[y_0,\ldots,y_k]$ некоторое
мономиальное упорядочение и обозначим через $G$ редуцированный базис
Гребнера идеала $I$ при этом упорядочении.

Рассмотрим $g(y_0,\ldots,y_k,n)\in K[y_0,\ldots,y_k][n]$ как многочлен с параметром. Отредуцируем все его мономы относительно $G$. В результате редукции мы получим некоторый многочлен $g'_n = g'(y_0,\ldots,y_k,n)$. Заметим, что
$$
{U} \subset \mathbf{V}(g_n)
\Leftrightarrow g_n\in I\Leftrightarrow
g'_n\equiv0.
$$
Приведём подобные слагаемые в $g'_n$:
$$
g'_n(y_0,\ldots, y_k)=\sum_i\limits t_i(n)r_i(y_0,\ldots, y_k),
$$
где $r_i$~--- мономы, а $t_i(n)\in\mathbb{K}[n]$~--- некоторые многочлен от $n$.
В силу определения $g'$,
$$
g'_n\in I\Leftrightarrow\, \forall\, j\,: t_j(n)=0,
$$
т.~е. искомое $n$ является решением системы уравнений от
одной переменной
$$
\forall\, j:t_j(n)=0\Leftrightarrow \text{НОД}(t_j(n))=0.
$$
Также заметим, что нам подходят только целые корни этого уравнения. Если исходные
многочлены были с рациональными коэффициентами, то все $t_j(n)$
тоже будут с рациональными коэффициентами, а следовательно,
все целые корни такого многочлена можно найти конечным перебором.
\end{remark}


Расмотрим счётный набор переменных $X=\{x_1,x_2,\ldots,x_p,\ldots\}$, $Y$~--- множество из первых нескольких переменных, возможно всех и $Z\subsetneq Y$. Пусть многочлены $g_1, g_2,\ldots, g_m\in K[Y]$ зависят только от переменных из множества $Z$. Обозначим идеалы $I_1=(g_1,\ldots, g_m)\in K[Z]$ и  $I_2=(g_1,\ldots, g_m)\triangleleft K[Y]$. Заметим, что любой многочлен из  $f\in K[Y]$ принадлежит  кольцу многочленов $f\in K[Z][Y\setminus Z]$, т.е. $f=\sum\limits_{i=1}^lf_ih_i$, где $h_i$~--- мономы от переменных из $Y\setminus Z$, $f_i$~--- многочлены из $K[Z]$. Докажем следующую лемму:

\begin{lemma}\label{lemma:extention ring}
В введённых выше обозначениях верно, что  если $f\in \sqrt{I_2}$, то $f_i\in \sqrt{I_1}$ для любого $i$. 
\end{lemma}
\begin{proof}
Введём в $K[Z][Y\setminus Z]$ лексикографический порядок на мономах. Предположим, что утверждение задачи не верно. Рассмотрим множество $A$, состоящее из всех многочленов, которые принадлежат $\sqrt{I_2}$, но в их представлении как многочленов из $f\in K[Z][Y\setminus Z]$, не все коэффициенты из $ \sqrt{I_1}$.   Выберем из $A$ многочлен $f$ такой, что его старший моном имеет наименьший порядок. Не ограничивая общности, мы можем считать, что самый старший моном в $f$ это $h_l$. Тогда $f_l\not\in\sqrt{I_1}$ так как иначе $f-h_lf_l\in A$ но его порядок будет меньше. Мы знаем, что  $f\in \sqrt{I_2}$, тогда $f^n=\sum\limits_{j=1}^mr_jg_j$, где $r_j\in K[Y]$. Распишем каждый $r_j$ как многочлен из $K[Z][Y\setminus Z]$, т.е.  $r_j=\sum\limits_{d_j=1}^{q}h_{d_j}f_{d_j}$,  где $h_{d_j}$~--- мономы от переменных из $Y\setminus Z$, $f_{d_j}$~--- многочлены из $K[Z]$. Тогда мы можем записать формальное равенство: 
$$
f^n=(\sum\limits_{i=1}^lf_ih_i)^n=h_l^nf_l^n+\ldots=\sum\limits_{j=1}^m\sum\limits_{d_j=1}^{q}h_{d_j}f_{d_j}g_j
$$

Заметим, что в сумме $(\sum\limits_{i=1}^lf_ih_i)^n$ после ракрытия скобок самый старший моном будет $h_l^n$, который единственный, слетельно в $f^n$  коэффициент перед ним равен $f_l^n$. Найдём справа все $h_{d_j}= h_l^n$. Тогда из формального равенства следует, что $f_l^n=\sum\limits_{h_{d_j}= h_l^n}f_{d_j}g_j\in K[z]$ следует, что $f_l^n\in I_1$. А это противоречит предположению $f_l\not\in\sqrt{I_1}$.
\end{proof}


Предыдущая как и следующая лемма являются общеизвестными, но мы не нашли на что сослаться, а доказывать все свойства идеала, получаемого при добавлении к кольцу новых переменных, невозможно в рамках этой работы. Поэтому следующий факт мы приводим без доказательств.

\begin{lemma}\label{lemma:extention ring2}
Даны два набора переменных $X=\{x_1,x_2,\ldots,x_n\}$ и $Y=\{x_1,x_2,\ldots,x_n,\ldots\}$ (второй может быть счётным). Пусть $I(g_1,\ldots, g_m)\triangleleft K[X]$, рассмотрим идеал $J=(g_1,\ldots, g_m)\triangleleft K[X]$. Тогда, если идеал $I$ обладал каким-либо из следующих свойств: радикален, тривиален, разлагался в пересечение простых идеалов или примарных компонент~--- то этими же свойствами обладает $J$. Более того, пораждающие элементы простых или примарных компонент и радикала также принадлежат кольцу $ K[X]$. 
\end{lemma}

\begin{lemma} \label{lemma:o proekcii}
Пусть $g_1,g_2,\ldots g_n\in K\{y\}$~--- множество многочленов,
%$R=\sqrt{(g_1,\ldots,g_n)}\subseteq K\{y\}$, 
$l=\max\limits_i\ord g_i$,
$I =(g_1,\ldots,g_n) \triangleleft K[y_0,\ldots,y_l]$ и $J =(g_1,\ldots,g_n) \triangleleft K[y_0,\ldots,y_q]$, где
$q\in \mathbb{N}\cup\{\infty\},q> l$. Пусть
$V=\mathbf{V}(J)\subseteq K^{q+1}$,
тогда $\Pi_l(V)=\mathbf{V}(I)$.
\end{lemma}

\begin{proof}

Пусть $a\in V$.
Тогда по теореме~\ref{theorem:th 0 for alg} $g_i(a)=0$ для любого $i$ от $1$ до $n$. Следовательно, так как $\ord g_i \le l$, то $g(\Pi_l(a))$ определено корректно и равно 0. Отсюда получается, что $\Pi_l(V)\subseteq\mathbf{V} (I)$.


Теперь  докажем обратное включение. Пусть $b\in \mathbf{V} (I)$  и $f\in J$. 
Рассмотрим произвольную точку $b'=(b,0,\ldots,0,\ldots)\in K^{q}$. Если мы докажем, что $f(b')=0$, то по той же теореме~\ref{theorem:th 0 for alg}  $b'\in V$ и $\Pi_l(b')=b$. А следовательно $$ \mathbf{V}(I)\subseteq\Pi_l(V)\Rightarrow \mathbf{V}(I)=\Pi_l(V).$$
Рассмотрим $f$  как многочлен в кольце $K[y_0\ldots,y_l][y_{l+1},\ldots,y_q]$, тогда мы можем записать, что $f=\sum\limits_{i=1}^lf_ih_i$, где $h_i$~--- мономы от переменных $y_{l+1},\ldots,y_q$, $f_i$~--- многочлены из $K[y_0\ldots,y_l]$. Тогда по лемме~\ref{lemma:extention ring} все $f_i\in \sqrt{I}\subseteq K[y_0\ldots,y_l]$. Значит $f_i(b')=0$ для любого $i$ по теореме гильберта о нулях. Отсюда следует, что $f(b')=0$.

\end{proof}


\section{Алгоритм, разделяющий случаи $[f]+(S_f)=(1)$ и $[f]+(S_f)\neq(1)$}

Мы знаем~\cite{Trushin}, что при выполнении условия $[f,S_f]=(1)$ наличие или отсутствие в $[f]$ квазилинейного многочлена равносильно равенству/неравенству $[f]+(S_f)=(1)$.
Также известно~\cite{E. R. Kolchin}, что из условия $[f]+(S_f)=(1)$ следует радикальность идеала $[f]$.
Возникает естественный вопрос: как алгоритмически разделить эти два случая?
Мы дадим на него ответ. Более того, так как $S_f$~--- частная производная по старшей переменной, мы будем решать следующую более общую задачу: дано $[f,\frac{\partial f}{\partial y_0},\ldots, \frac{\partial f}{\partial y_l}]=(1)$, где $l=\ord f$; требуется проверить, равен ли единичному идеал $[f]+(h_1,h_2,\ldots,h_t)$, где $\{h_1,h_2,\ldots,h_t\}\subset K\{y\}$.

В дальнейшем нас будет интересовать решение системы
\begin{equation}
\label{eq1}
h_1=h_2=\ldots=h_m=f=\ldots=\ldots=f^{(n)}=\ldots=0.
\end{equation}

Введём некоторые обозначения.
\begin{enumerate}
  

  \item $l:=\ord (f);$
  
  \item $S= \{\frac{\partial f}{\partial y_0},\ldots, \frac{\partial f}{\partial y_l}\}$~--- множество частных производных;

  \item Идеал $G_k := \sum\limits_{j=0}^l\left(\left(\frac{\partial f}{\partial y_j}\right)^{(k-l+j)}\right) = \left(\left(\frac{\partial f}{\partial y_0}\right)^{(k-l)},\ldots ,\left(\frac{\partial f}{\partial y_l}\right)^{(k)} \right)$;
  \\Если $k-l+j<0$, то считаем, что $\left(\frac{\partial f}{\partial y_j}\right)^{(k-l+j)} = 0$;

  \item Многочлен $g_{k,n}:=\sum\limits_{j=0}^{l}C_n^{k-l+j}\left(\frac{\partial f}{\partial y_j}\right)^{(k-l+j)}$;

  \item Выберем  такие $p_0, \ldots, p_l, w\in \mathbb{N}$, что $\left(f,\ldots, f^{(w)}, \dfrac{\partial f}{\partial y_0},\ldots,(\dfrac{\partial f}{\partial y_0})^{(p_0)},\ldots, \dfrac{\partial f}{\partial y_l},\ldots,(\dfrac{\partial f}{\partial y_l})^{(p_l)}\right)=(1)$, они существуют в силу условия  $[f,S_f]=(1)$;

  \item ${V}_{f,n}:=\mathbf{V}\left(h_1,\ldots,h_t,f,\ldots f^{(n)}\right)\subseteq K^{\infty}$;

  \item  ${V}_{f}:=\bigcap\limits_{n=0}^{\infty}V_{f,n}$.
  
  \item $p= \max\{ p_0+0,\ldots,p_l+l\}$

%  \item Дано многообразие ${\mathbf{H}}$.  Разложение $\mathbf{H}$ на неприводимые многообразия будем обозначать: $\mathbf{\mathbf{H}}= \bigcup\limits_{j=1}^{k}\mathbf{L}_{j}(\mathbf{H})$. 
\end{enumerate}



Пусть $n \ge\max\{2p+1,\ord{h_1},\ldots,\ord{h_t},l,w\}$. Рассмотрим набор многообразий ${U}_k^n$, $0\le k\le p$, заданный следующим образом:
\begin{gather*}
{U}_{0}^n:={V}_{f,n},\\
{U}_k^n:={V}_{f,n+k}\bigcap\left(\bigcap\limits_{m=0}^{k-1}\mathbf{V}\left(G_m\right)\right) \quad \text{ при } k>0.
\end{gather*}

Каждое из ${U}^n_k$ разложим на неприводимые многообразия $W=\{{W}_{1},\ldots,{W}_{n_k}\}$. Пусть $V^n_k=\{{V}^n_{k,1},\ldots,{V}^n_{k,i_k}\}$~--- все элементы $W$, удовлетворяющие условию ${W}_{j}\not\subseteq\mathbf{V}(G_k)$.

Пусть  $S_k^n=\left(h_1,\ldots,h_t,f,\ldots,f^{(n+k)}\right)+G_0+\ldots+ G_{k-1}\triangleleft K\{y\}$. Из определения ${U}_k^n$ видно, что ${U}_k^n=\mathbf{V}(S_k^n)\subseteq K^{\infty}$. Каждому многообразию ${V}_{k,i}^n$ соответствует радикал $R_{k,i}^n$ некоторой примарной компоненты идеала $S_k^n$, множество этих радикалов обозначим через $R^n_k$.


\begin{lemma} \label{lemma:o_ideale}
 В выше обозначенных условиях для любого $i$ множество $\Pi_{n+l}({V}_{k,i}^n)$ является многообразием, где $n \ge\max\{ 2p+1,\ord{h_1},\ldots,\ord{h_t},l,w\}$ и  $0\le k\le p$.
\end{lemma}

\begin{proof}
Рассмотрим многочлен $f^{(m)}$, $n<m\le n+k$. По следствию~\ref{corollary:deriv_equal} и определению $g_{k,n}$ верно, что

$$
f^{(m)}= \sum\limits_{i=0}^{m-n-1} S_{f,m,i}y_{m+l -i} + f_{m,n}=\sum\limits_{i=0}^{m-n-1} g_{i,m}y_{m+l -i} + f_{m,n},
$$
где многочлен $f_{m,n}$ не зависит от переменных старше $y_{n+l}$. Заметим, что $\sum\limits_{i=0}^{m-n-1} g_{i,m}y_{m+l -i}$ принадлежит идеалу  $(G_0,\ldots, G_{k-1})\triangleleft K[y_0,\ldots,y_{k+n+l}]$,  порождающие которого зависят от переменных не старше $y_{n+l}$.

Рассмотрим идеал

$$
T_k^n=(h_1,\ldots,h_t,f,\ldots,f^{(n)},f_{n+1,n},\ldots,f_{n+k,n}) + G_0+\ldots+ G_{k-1}\triangleleft K[y_0,\ldots,y_{n+l}].
$$

Тогда порождающие идеала $S_k^n$, а следовательно радикалов всех его примарых компонент по лемме~\ref{lemma:extention ring2}, принадлежат кольцу $K[y_0,\ldots,y_{n+l}]$. По лемме~~\ref{lemma:o proekcii} верно, что
$$
\Pi_{n+l}({V}_{k,i}^n)=\mathbf{V}(R_{k,i}^n\bigcap K[y_0,\ldots,y_{n+l}]).
$$
Последнее многообразие рассматриваются в пространстве $K^{n+l+1}$.
\end{proof}


\begin{remark}\label{remark:o_prinadleznosti_reshenia}
Предположим, что $[f,S]=(1)$, а $[f]+(h_1,\ldots,h_t)\neq (1)$. Тогда ${V}_{f}$ не пусто. Рассмотрим точку $b\in{V}_{f}$. Докажем, что она принадлежит хотя бы одному из многообразий ${V}_{k,i}^n$ при фиксированном $n$. Мы знаем, что 
\begin{gather*}
\varnothing=\mathbf{V}\left(f,\ldots,f^{(w)},\dfrac{\partial f}{\partial y_0},\ldots,(\dfrac{\partial f}{\partial y_0})^{(p_0)},\ldots, \dfrac{\partial f}{\partial y_l},\ldots,(\dfrac{\partial f}{\partial y_l})^{(p_l)}\right)\supseteq \\
\supseteq \mathbf{V}\left(h_1,\ldots,h_t,f,\ldots,f^{(w)}\right)\bigcap\mathbf{V}\left(\dfrac{\partial f}{\partial y_0},\ldots,(\dfrac{\partial f}{\partial y_0})^{(p_0)},\ldots, \dfrac{\partial f}{\partial y_l},\ldots,(\dfrac{\partial f}{\partial y_l})^{(p_l)}\right)=\varnothing.
\end{gather*}
 А так как $b\in \mathbf{V}\left(h_1,\ldots,h_t,f,\ldots,f^{(w)}\right)$, то $b$ не может входить в $\mathbf{V}\left(\dfrac{\partial f}{\partial y_0},\ldots,(\dfrac{\partial f}{\partial y_0})^{(p_0)},\ldots, \dfrac{\partial f}{\partial y_l},\ldots,(\dfrac{\partial f}{\partial y_l})^{(p_l)}\right)$, т.е. найдётся такое $(\dfrac{\partial f}{\partial y_j})^{(j)}(b)\ne 1$.  Следовательно, существует $i\le p$, такое, что $b \not\in \mathbf{V}(G_i)$, так как среди порождающих элементов идеала $G_i$ имеется $\left(\frac{\partial f}{\partial y_0}\right)^{(i-l)},\ldots ,\left(\frac{\partial f}{\partial y_l}\right)^{(i)} $. Остаётся взять наименьшее такое $i$, и получим, что $b\in {U}_{i}^n$, а вместе с этим $b$ лежит и в какой-то неприводимой компоненте ${U}_{i}^n$, не принадлежащей $\mathbf{V}(G_{i})$.
\end{remark}

\begin{definition}
Пусть $f\in K\{y\}$, $[f,S]=(1)$.  Глубиной решения $b\in {V}_f$  будем называть число $k$, такое, что $b\in {U}_k^n$, но $b\not\in {U}_{k+1}^n$, при $n \ge\max\{ 2p+1,\ord{h_1},\ldots,\ord{h_t},\ord{f},w\}$ .
\end{definition}



\begin{lemma}\label{lemma:o_nasledovanii}
Глубина решения не зависит от выбора $n$.

%Пусть $b\in\mathbf{V}_f$ и выполнено следующее условие: существует $d$, что $b\in\mathbf{U}_{d}^{n_1}$, но $b\not\in\mathbf{U}_{d+1}^{n_1}$ . Тогда  для любого $n_2\ge n_1$ $b$ принадлежит $\mathbf{U}_{d}^{n_2}$ , и для $ d_1>d$ выполнено $b\not\in\mathbf{U}_{d_1}^{n_2}$ . Тем самым глубина решения не зависит от $n$.
\end{lemma}

\begin{proof}
Предположим противное: пусть существует решение $b\in{V}_f$ и существуют $n_1$ и $n_2$, такие, что глубина $b$ при $n_1$ равна $d_1$, а при $n_2$ равна $d_2$, и $d_1\not=d_2$. Заметим, что так как ${U}_k^n={V}_{f,n+k}\bigcap\left(\bigcap\limits_{m=0}^{k-1}\mathbf{V}\left(G_m\right)\right)$, то принадлежность $b$  многообразию ${U}_{d_1}^{n_1}$ и отсутствие $b$ в ${U}_{d_1+1}^{n_1}$ означает, что $b\not\in\bigcap\limits_{m=0}^{d_1}\mathbf{V}\left(G_m\right)$ и $b\in\bigcap\limits_{m=0}^{d_1-1}\mathbf{V}\left(G_m\right)$. Аналогично, получаем, что $b\not\in\bigcap\limits_{m=0}^{d_2}\mathbf{V}\left(G_m\right)$ и $b\in\bigcap\limits_{m=0}^{d_2-1}\mathbf{V}\left(G_m\right)$. Не ограничивая общности, пусть $d_1<d_2$. Но тогда мы приходим к противоречию: 
$$
b\in\bigcap\limits_{m=0}^{d_2-1}\mathbf{V}\left(G_m\right)\subseteq\bigcap\limits_{m=0}^{d_1}\mathbf{V}\left(G_m\right).
$$
%Значит, наше предположение неверно. Следовательно, для всех допустимых $n$ глубина решения одна и та же.
\end{proof}

\begin{remark}\label{remark:o_sushestvovanii_gllubiny} Итак, глубина решения корректно определена для любого $b\in {V}_f$.
\end{remark}
\begin{example}
Рассмотрим многочлен $f=y_1^2+y_1y+\frac{1}{2}y+1$. Отметим, что это многочлен удовлетворяет условию $[f,S_f]=(1)$, т.к. $S_f=y_0+2$, а следовательно уравнение $f=S_f=0$ имеет единственное решенние $(-2,0)$, значит дифференциальных решений нет. Начнём последовательно решать системы уравнений $f=0$, $f=f^{(1)}=0$, $(f=f^{(1)}=f^{(2)}=0$,\ldots,$f=f^{(1)}=\ldots=f^{(n)}=0$. Естественно, чтобы решить каждую следующую, надо взять решение предыдущей и подставить его в новое уравнение $f^{(n)}=0$. 

Заметим, что каждый раз у нас будет два набора решений. Первый набор будет соответствовать случаю $S_f\ne 0$ ($y_0\ne -2$). В нём мы однозначно  по $y_0$ будем последовательно  находить все остальные переменные:   $f^{(n)}=y_{n+1}S_f+g=y_{n+1}(y_0+2)+g$, где  $g$ не зависит от переменных порядка $y_{n+1}$. Зная  перменные $y_0,\ldots,y_n$ мы однозначно найдём $y_{n+1}$. Второй набор решений будет соответствовать  случаю $S_f=0$, тогда из уравнений $f=f^{(1)}=0$ можно найти, что $y_0=-2,y_1=0$. А из набора уравнений  $f=f^{(1)}=\ldots=f^{(n)}=0$ мы сможем последовательно определить однозначно только первые $n$ переменных, в отличии от предыдущего случая. Каждый  многочлен $f^{(n)}$ мы можем предствавить в виде $f^{(n)}=y_{n+1}S_f+(ny_1+y_1+\dfrac{1}{2})y_n+g'$ (это равенство следует из  следствия~\ref{corollary:deriv_equal}), где  $g'$ не зависит от переменных порядка $y_{n}$ и выше. Т.к. $S_f$ равно 0 в нашем случае, то переменным $y_0,\ldots,y_{n-1}$ мы можем найти $y_n$. Первые решения соответствуют глубине 0, а вторые глубине 1.

\end{example}


\begin{definition}
Пусть имеется счётный набор многочленов
$$
G=\{h_1,\ldots,h_m,\ldots\,\}\subset K\{y\}.
$$
Рассмотрим набор из $i$ первых многочленов $G'=\{h_1,\ldots,h_i\}$, $G'\subseteq K[y_0,y_1,\ldots
y_n]$, и пусть
$$
t=(a_0,\ldots,a_n)\in K^{n+1}
$$
--- формальное решение системы уравнений $h_1=\ldots=h_i=0$. Тогда мы будем говорить, что формальное решение
$t$ 
\begin{itemize}
\item[--] \emph{продлевается} до формального решения системы
\begin{equation}\label{eq2}
h_1=\ldots=h_i=h_{i+1}=0,
\end{equation}
где $h_{i+1}\subseteq K[y_0,y_1,\ldots y_{n+m}]$,
если существуют такие $a_{n+1},\ldots, a_{n+m}\in K$, что
$t'=(a_0,\ldots,a_n,\ldots,a_{n+m})\,\in K^{n+m}$~--- решение
системы~\eqref{eq2};
\item[--] соответственно, \emph{продлевается} до решения системы $G$, если
его можно последовательно продлить до решения системы 
$$
h_1=\ldots=h_i=\ldots=h_{j}=0$$
при любом $j > i$.
\end{itemize}
\end{definition}
%!!!!!!



\begin{definition}
Пусть многочлен $g(y_0,\ldots,y_t,n)\in K\{y\}$, где $n\in \mathbb{Z}\cup\{\infty,-\infty\}$~--- некоторый параметр.
Определим функцию $\psi(g(y_0,\ldots,y_t,n),{U})$, которая по многочлену $g(y_0,\ldots,y_t,n)$ и  многообразию ${U}\subseteq K^m$, где $t< m$ или $m=+\infty$, возвращает максимальное $n_0$, для которого выполнено ${U}\subseteq \mathbf{V}(g(y_0,\ldots,y_t,n_0))\subseteq K^m$. Если максимального нет, то возвращает $+\infty$. Если вообще таких  $n_0$ нет, то возвращает $-\infty$.
\end{definition}
\begin{remark}\label{remark: zamena_mnogoobrazia_na_ideal}
По теореме~\ref{theorem:th 0 for alg} вложение ${U}\subseteq \mathbf{V}(g(y_0,\ldots,y_t,n_0))\subseteq K^m$ равносильно вложению $g(y_0,\ldots,y_t,n_0)\in \mathbf{I}(U)$. А следовательно, мы можем рассматривать функцию  $\psi$ не от многочлена и многообразия, а от многочлена и простого идеала, соответствующего этому многообразию  $\psi(g(y_0,\ldots,y_t,n),{\mathbf{I}( U)})$.
\end{remark}
\begin{lemma}\label{lemma:o_ravenste_psi}
Пусть ${V}_{k,i}^{n_0}$ и $g_{d,n}$ удовлетворяют введённым нами обозначениям и  $d\le p$. Тогда имеется равенство $$\psi(g_{d,n},\Pi_{n_0+l}({V}_{k,i}^{n_0}))=\psi(g_{d,n},{V}_{k,i}^{n_0}).$$
\end{lemma}

\begin{proof}
Утверждение леммы непосредственно следует из того, что ${V}_{k,i}^{n_0}$ соответствует радикальный идеал $R_{n,i}^k$, порождающие которого лежат в кольце $K[y_0,\ldots,y_{n_0+l}]$, которому также принадлежит $g_{d,n}$.
\end{proof}


\begin{theorem}\label{theorem:general th1}

Пусть $K$~--- алгебра Ритта континуальной мощности, $f,h_1,\ldots,h_t,\in K\{y\}$ и $[f,S]=(1)$. Тогда в введённых выше обозначениях, если для некоторого непустого ${V}_{k,i}^{n_0}$ верно, что
\begin{equation}
\psi(g_{k,n},\Pi_{n_0+l}({V}_{k,i}^{n_0}))\le n_0+k,
\end{equation}
то все точки $\Pi_{n_0+l}({V}_{k,i}^{n_0})$, кроме быть может счётного числа подмногообразий меньшей размерности, продлеваются до формального решения системы~\eqref{eq1}.
\end{theorem}

\begin{proof}
Пусть $a\in {V}_{k,i}^{n_0}$ и $b=\Pi_{n_0+l}(a)$. Предположим, что $b$ ни при каком $m>0$ не зануляет многочлен $g_{k,k+n+m}$. Тогда докажем по индукции, что $b$ продолжается до решения системы (1).

\emph{База.} Из доказательства леммы~\ref{lemma:o_ideale} следует, что при подстановке $b$ в многочлены $h,f,\ldots,f^{(n_0+k)}$ становятся тождественно равны 0, что и требовалось.

\emph{Предположение индукции.} Предположим, что мы сумели продлить $b$ до $b'\in K^{n_0+l+m}, 0< m$~--- решения системы $h=f=\ldots=f^{(k+n_0+m-1)}=0$.

\emph{Переход.} Докажем, что существует такая точка $b''\in K^{n_0+l+m+1}$, что $\Pi_{n_0+m+l-1}(b'')=b'$ и при подстановке $b''$ в систему $h=f=\ldots=f^{(k+n_0+m)}=0$ она вырождается в верные тождества.

Рассмотрим $f^{(k+n_0+m)}$. По следствию~\ref{corollary:deriv_equal} и определению $g_{k,n}$ верно, что

$$
f^{(k+n_0+m)}=\sum\limits_{j=0}^{k-1} g_{j,k+n_0+m}y_{k+n_0+m+l -j}+g_{k,k+n_0+m}y_{n_0+m+l}  + Q,
$$

где многочлен $Q$ и многочлен $g_{k,k+n_0+m}$ зависят от переменных, порядок которых меньше $n_0+l+m$. В силу построения ${V}_{k,i}^n$, любая точка из ${V}_{k,i}^{n_0}$ зануляет $g_{j,k+n_0+m}$, так как $j < k$ и $g_{j,k+n_0+m}\in G_j\subseteq S_k^{n_0}$. Так же $\ord g_{j,k+n_0+m}<y_{n_0+l}$ (доказано в следствии~\ref{corollary:deriv_equal}). Следовательно, при подстановке в $f^{(k+n_0+m)}$ точки $b'$ получим, что первая часть станет тождественным нулём, так как $b=\Pi_{n_0+l}(a)=\Pi_{n_0+l}(b')$. Обозначим $Q(b')=r\in K$ и $g_{k,k+n_0+m}(b')=t\neq 0\in K$ по предположению (так как $\ord g_{k,k+n_0+m}< n_0+l$, то выражение $g_{k,k+n_0+m}(b')$ корректно определено и совпадает со значением $g_{k,k+n_0+m}(b)$). Получаем, что уравнение $f^{(k+n_0+m)}$ свелось к линейному уравнению $t y_{n_0+m+l}+r=0\Rightarrow y_{n_0+m+l}=-\frac{r}{t}$. Итого мы продолжили $b'$ до решения $h=f=\ldots=f^{(k+n_0+m)}=0$.

 Так как $\psi(g_{k,n},\Pi_{n_0+l}({V}_{k,i}^{n_0}))\le n_0+k$, то существует такое $b\in \Pi_{n_0+l}({V}_{k,i}^{n_0})$,  которое не зануляет $g_{k,j}$ ни при каком $j>n_0$, так как иначе все точки ${V}_{k,i}^{n_0}$ содержались бы в счётном объединении многообразий $\mathbf{V}(g_{k,n})$, но целиком ${V}_{k,i}^{n_0}$ не лежало бы ни в одном из них по условию (2), это противоречит лемме~\ref{lemma:o vlojenii}. Соответственно продлеваются все точки из $${V}_{k,i}^{n_0}\backslash \bigcup\limits_{j=n_0+k+1}^{+\infty}\mathbf{V}(g_{k,j}).$$
 \end{proof}


Заметим, что все ${V}_{k,i}^n$ образуют частично упорядоченное множество по включению. Действительно, из определения ${U}_{k}^n$ следует, что ${U}_{d}^n\supseteq {U}_{d}^m$ для любых $m >n$ и $0\le d\le p$. Следовательно,
все неприводимое компоненты ${U}_{d}^m$ содержатся в каких-то неприводимых компонентах ${U}_{d}^n$.



\begin{definition}
Будем говорить, что ${V}_{d,j}^{n_2}$~--- \emph{наследник решения} ${V}_{d,i}^{n_1}$, если $n_2>n_1, 0\le d\le p$ и
$$
\left\{
 \begin{aligned}
 {V}_{d,j}^{n_2}\subseteq {V}_{d,i}^{n_1},\\
 \psi(g_{d,n},{V}_{d,i}^{n_1})=n_2.\\
 \end{aligned}
 \right.
$$
\end{definition}

\begin{remark}\label{remark:o_konechnosti_psi}
Отметим, что $\psi(g_{d,n},{V}_{d,i}^{n_0})$ не может равняться $+\infty$  для не пустого ${V}_{d,i}^{n_0}$. Действительно, если это не так, то существует бесконечно много $n$, таких, что ${V}_{d,i}^{n_0}\subseteq \mathbf{V}(g_{d,n})$. Так как ${V}_{d,i}^{n_0} \not\subseteq \mathbf{V}(G_d)$, то существует точка $b\in {V}_{d,i}^{n_0}$ такая, что хотя бы один из многочленов $\left\{\left(\frac{\partial f}{\partial y_0}\right)^{(d-l)},\ldots, \left(\frac{\partial f}{\partial y_l}\right)^{(d)} \right\}$ не равен 0 в точке $b$.

Заметим, что $C_n^k=\frac{(n-1)\cdot\ldots(n-k+1)}{k!}$, следовательно при фиксированном $k$ биномиальный коэффициент $C_n^k$ можно рассматривать как многочлен от $n$.

Рассмотрим многочлен от $n$
$$
g_{d,n}(b)=\sum\limits_{j=0}^{l}C_n^{j+d - l }\left(\frac{\partial f}{\partial y_j}\right)^{(j+d - l)}(b)\in K[n].
$$
Этот многочлен не тождественный 0, так как существует коэффициент $\left(\frac{\partial f}{\partial y_j}\right)^{(j+d - l)}(b)$, не равный 0, а $C_n^{j+d - l }$~---линейно независимые многочлены от $n$, степени не больше $d$. Однако, если существует бесконечно много $n$, что ${V}_{d,i}^n\subseteq \mathbf{V}(g_{d,n})$, следовательно при каждом таком $n_0$ многочлен $g_{d,n_0}(b)$ равен 0. Т.е. $g_{d,n}(b)$ имеет бесконечно много корней, что противоречит, что $g_{d,n}(b)$ не равен тождественно 0.
\end{remark}

\begin{definition}
Цепочкой будем называть последовательность многообразий, каждое  из которых, кроме первого, является наследником предыдущего.
\end{definition}

\begin{lemma}\label{lemma:o_konechnosti_cepochek}
Любая цепочка, начинающаяся с ${V}_{d,k}^{n}$ состоит не более чем из  $d+1$ члена, включая ${V}_{d,k}^{n}$.
\end{lemma}

\begin{proof}
Предположим, что  существует цепочка более чем из $d+1$ члена. Рассмотрим первые $d+2$  члена в ней. Пусть $a$ их общая точка. Тогда не нулевой многочлен $g_{d,n}(a)$ степени не более $d$ имеет минимум $d+1$  корень (в силу определения наследования и функции $\psi$), пришли к противоречию.
\end{proof}


\begin{remark}\label{remark:o_syshestvovvanii reshenia c zadannoi glubinoi}
Итак, мы знаем, что если ${V}_f\neq\emptyset$, то для любого $b\in {V}_f$ определено понятие глубины. Покажем, что мы можем определить : существует ли решение системы (1) с заданной глубиной $k$.

Зададимся числом $n_0\ge\max\{ 2p+1,\ord{h_1},\ldots,\ord{h_t},\ord{f}\}$. Рассмотрим все ${V}_{k,i}^{n_0}$ из $V_k^{n_0}$  и для каждого вычислим $a_i=\psi(g_{k,n}, {V}_{k,i}^{n_0})$. Мы знаем, что если $a_j\le n_0$, то по теореме~\ref{theorem:general th1} существуют точки из ${V}_{k,j}^{n_0}$, которые продолжаются до формального решения системы (1). Предположим, все $a_j>n_0$, тогда найдём максимальное из них $n_1$ (по замечанию~\ref{remark:o_konechnosti_psi} каждое $a_i$ конечно) и повторим процедуру для многообразий ${V}_{k,i}^{n_1}$. И так далее. Таким образом мы построим последовательность чисел $n_0,n_1,n_2,\ldots$.

Докажем, что эта цепочка конечна, а именно, что в ней не больше $k+1$ члена. Рассмотрим произвольное ${V}_{k,i_{k+1}}^{n_{k+1}}$  и найдём ${V}_{k,i_{k}}^{n_{k}}\supseteq {V}_{k,i_{k+1}}^{n_{k+1}}$ . Последовательно построим ${V}_{k,i_{l}}^{n_{l}}\supseteq {V}_{k,i_{l+1}}^{n_{l+1}}$ при $l\ge 0$. Мы получили цепочку многообразий
$$
{V}_{k,i_{0}}^{n_{0}}\supseteq\ldots\supseteq {V}_{k,i_{k+1}}^{n_{k+1}}.
$$
   Как мы знаем, что из условия ${V}_{k,i}^n \not\subseteq \mathbf{V}(G_k)$ следует, что существует точка $b\in {V}_{k,i_{k+1}}^{n_{k+1}}$ такая, что хотя бы один из многочленов $\left\{\left(\frac{\partial f}{\partial y_0}\right)^{(k-l)},\ldots, \left(\frac{\partial f}{\partial y_l}\right)^{(k)} \right\}$ не равен 0 в точке $b$.
Рассмотрим многочлен от $n$
$$
g_{k,n}(b)=\sum\limits_{j=0}^{l}C_n^{j+k - l }\left(\frac{\partial f}{\partial y_j}\right)^{(j+k - l)}(b)\in K[n].
$$
Это ненулевой многочлен. Из построения множеств ${V}_{k,i_{0}}^{n_{0}},\ldots, {V}_{k,i_{k+1}}^{n_{k+1}}$ следует, что на промежутках $$[n_0,n_1],[n_1,n_2],\ldots,[n_k,n_{k+1}]$$
многочлен имеет корень, а степень его не выше $k$. Мы пришли к противоречию, следовательно наша последовательность  $n_0,n_1,n_2,\ldots$ имеет не более $k$ членов. Тогда посмотрим почему мы могли остановиться при построении нашей последовательности:

\begin{enumerate}
  \item Все построенные вновь ${V}_{k,i}^{n_j}$ пустые.
  \item Нашёлся ${V}_{k,m}^{n_j}$ такой, что $ \psi(g_{k,n},{V}_{k,m}^{n_j})\le n_j$.
\end{enumerate}

Мы знаем, что если выполнено 2, то существуют точки из ${V}_{k,m}^{n_j}$, которые продолжаются до формального решения системы (1), а это как раз то, что нам и надо. Если выполнено первое, то из замечания~\ref{remark:o_sushestvovanii_gllubiny} следует, что нет решений системы (1)  с глубиной $k$. Так как если бы они были, то для любого $n$ на нашлось бы непустое ${V}_{k,m}^{n}$ содержащее данное решение.

Осталось заметить, что так как глубина решения не может превосходить $p$, то для проверки $[f]+(h_1,\ldots,h_t)=(1)$ нам нужно проверить существование решений всех глубин не больших $p$. Если не нашлось ни для какой глубины решения, то $[f]+(h_1,\ldots,h_t)=(1)$, иначе $[f]+(h_1,\ldots,h_t)\neq(1)$.
\end{remark}

{\bf Вход:} $K\{y\}$~--- кольцо дифференциальных многочленов, где $K$ является алгеброй Ритта, континуальной мощности, $f,h_1,\ldots,h_t \in K\{y\}$ с условием $[f,S]=(1)$.

{\bf Выход:} TRUE, если  $[f]+(h_1,\ldots,h_t)=(1)$, и FALSE, если не $[f]+(h_1,\ldots,h_t)\not=(1)$.
\\
1.\qquad If $[f,S]\not=(1)$, Return  INCORRECT DATA;\\
2.\qquad Find $p_0, \ldots, p_l, w\in \mathbb{N}$ such that $\left(f,\ldots, f^{(w)}, \dfrac{\partial f}{\partial y_0},\ldots,(\dfrac{\partial f}{\partial y_0})^{(p_0)},\ldots, \dfrac{\partial f}{\partial y_l},\ldots,(\dfrac{\partial f}{\partial y_l})^{(p_l)}\right)=(1)$;\\
3.\qquad For all $k\le p =\max\{ p_0+0,\ldots,p_l+l\} $\\
4.\qquad\qquad Let $n_0:=\max\{ 2p+1,\ord{h_1},\ldots, \ord{h_t},\ord{f},w\}$;\\
5.\qquad\qquad $g_{k,n}:=\sum\limits_{j=0}^{l}C_n^{j+k - l }\left(\frac{\partial f}{\partial y_j}\right)^{(j+k - l)}$;\\
6.\qquad\qquad While($n_0\not=\infty$)\\
7.\qquad\qquad\qquad If $R_k^{n_0}=\emptyset$, BREAK;\\
8.\qquad\qquad\qquad Let $A:=\emptyset$;\\
9.\qquad\qquad\qquad For all ${R}_{k,i}^{n_0}\in R_k^{n_0}$\\
10.\qquad\qquad\qquad\qquad $a_i=\psi(g_{k,n},{R}_{k,i}^{n_0})$;\\
11.\qquad\qquad\qquad\qquad If $a_i\le n_0$, Return FALSE;\\
12.\qquad\qquad\qquad\qquad $A=A\cup\{a_i\}$;\\
13.\qquad\qquad\qquad $n_0=\max\{A\}$;\\
14.\qquad Return TRUE;

Множество $V_k^{n}$ определено в начале раздела, многообразиям ${V}_{k,i}^{n}$ соответствуют радикальные идеалы $R_{k,i}^{n}$, являющиеся примарными компонентами идеала $S_k^n$, т.е. вычислимы образующие этих идеалов. 
Функция $\psi(g_{k,n},{V}_{k,i}^{n_0})$ вычислима в силу замечания~\ref{remark:o vlojenii} и леммы~\ref{lemma:o_ravenste_psi}.
\section{Примеры}


\begin{example}\label{example:first}
 Рассмотрим многочлен $f= -y_1^2+ay_1^2y+byy_1+c$.
Все параметры не равны 0. При каких значениях параметров выполнено,
что $[f]+(S_f)=(1)$?

$S_f=-2y_1+2ay_1y+by$;
\\
$f^{(1)}=(-2y_1+2ay_1y+by)y_2+(ay_1^2+by_1)y_1$;
\\
$f^{(2)}=(-2y_1+2ay_1y+by)y_3+(-2y_2+2ay_2y+5ay_1^2+3by_1)y_2=(-2y_1+2ay_1y+by)y_3+((-2+2ay)y_2+2ay_1^2)y_2+3(ay_1^2+by_1)y_2 $.

Для начала нам надо понять при каких значениях параметров выполнено
$[f,S_f]=(1)$. Последнее означает отсутствие дифференциальных решений
у системы $f=0, S_f=0$. Давайте попробуем найти хоть какие-нибудь решения.
Если $y_1=0$, то из $S_f=0, f=0$ следует, что $y=0, c =0$, что
противоречит тому, что параметры не равны 0. Следовательно при
$y_1=0$ решений вообще нет. 

Пусть $y_1\not=0$, тогда из системы $f^{(1)}=0, S_f=0$
следует, что $by_1+ay_1^2=0\Longrightarrow y_1=-\frac{b}{a}$ Т.е.
$y_1$ всегда константа, не равная 0. Подставляем в $S_f$ $y_1=-\frac{b}{a}$ и
получаем $2\frac{b}{a}-by=0$. Отсюда следует, что и $y$ всегда
константа $\Rightarrow [f,S_f]=(1) $.
 
 Подставим теперь $y_1$ в $f=0$ и получим, что $-\frac{b^2}{a^2}+c=0$.
Следовательно если это не выполнено, то система $f=f^{(1)}=S_f=0$ не
совместна, а следовательно $[f]+(S_f)=(1)$. Докажем теперь, что если это
выполнено, то $[f]+(S_f)\not=(1)$

Найдём $p$ и $w$ для нашего многочлена. Для этого найдём $
S_f^{(1)}=(-2+2ay)y_2+by_1+2ay_1^2$. Подставляя в уравнение $
S_f^{(1)}=0$ найденные нами $y,y_1$ получаем $ 2y_2+\frac{b^2}{a}=0$.С учётом уравнения $f^{(2)}=0$ получаем, что $\left(f,f^{(1)},f^{(2)},S_f, S_f^{(1)}\right)=(1)\Rightarrow p=1,w=2\ord{h}=0,\ord{f}=1$, т.е. начальное $n$  мы можем брать начиная с 3.

Решений глубины 0 быть не может, так как ${U}_0^n = \mathbf{V}(h=S_f,f,\ldots f^{(n)})\subseteq\mathbf{V}(G_0=S_f)$.

Ищем решения глубины 1. Рассмотрим $g_{1,n}=nS_f^{(1)}+(\frac{\partial f}{\partial y})$. Отметим, что из равенства $f^{(1)}=(-2y_1+2ay_1y+by)y_2+(ay_1^2+by_1)y_1$ следует, что $\frac{\partial f}{\partial y} \in f+f^{(1)}+S_f$. 
  $$
  \psi( g_{1,n},{V}_{1,i}^3)=\psi( nS_f^{(1)}+(\frac{\partial f}{\partial y}),{V}_{1,i}^3)=\psi( nS_f^{(1)},{V}_{1,i}^3).
  $$
Последнее равенство верно в силу того, что если ${V}_{1,i}^3\subseteq \mathbf{V}(nS_f^{(1)}+(\frac{\partial f}{\partial y}))\Leftrightarrow {V}_{1,i}^3\subseteq \mathbf{V}(nS_f^{(1)})$, так как ${V}_{1,i}^n\subseteq {U}_k^n=\mathbf{V}(S_f,f,\ldots,f^{n})$. А $\psi( nS_f^{(1)},{V}_{1,i}^3)= 0<3$ так как $\left(f,f^{(1)},f^{(2)},S_f, S_f^{(1)}\right)=(1)$. Мы получили, что решения глубины один существуют, значит $[f]+(S_f)=(1)\Leftrightarrow -\frac{b^2}{a^2}+c=0$.



\end{example}



\begin{example}
 Теперь рассмотрим многочлен $f =
(y_1-a)^2+by^4y_1^2$. Коэффициенты не равны 0.

$S_f=2(y_1-a)+2by^4y_1$;
\\
$f^{(1)}=(2(y_1-a)+2by^4y_1)y_2+4by^3y_1^3$

Рассмотрим систему уравнений $f=S_f=f^{(1)}=0$. Из второго и
третьего уравнения вытекает, что $y^3y_1^3=0$. Подставляя в первое
получаем, что $y_1=a, y=0$, что означает отсутствие дифференциальных
решений системы $f=S_f=0$, т.е.$[f,S_f]=(1)$.

Найдём теперь  $p$ для нашего многочлена $f$. Для этого рассмотрим
систему $f=S_f=(S_f)^{(1)}=(S_f)^{(2)}=f^{(1)}=f^{(2)}=f^{(3)}=f^{(4)}=0$. Эта система оказывается несовместной. Следовательно,
$p=2,w=4\ord{h}=1,\ord{f}=1$. Начальное $n$  можно брать равным 4.

Рассмотрим систему $f=S_f=f^{(1)}=f^{(2)}=f^{(3)}=f^{(4)}=0$, из неё мы получим, что $y=0,y_1=a,y_2=0,y_3=\pm2ib^{-1/2}a^3$, другими словами, это $\Pi_3({V}_{4,f})$. 
Как и в предыдущем примере искать решения глубины 0 не имеет смысла, так как ${U}_0^n = \mathbf{V}(h=S_f,f,\ldots f^{(n)})\subseteq\mathbf{V}(G_0=S_f)$.  Решения глубины 1. $g_{1,n}=C_n^1(S_f)^{(1)}+\frac{\partial f}{\partial y}=n(y_2+by_2y^4+4by_1^2y^3)+4by^3y_1^3\Rightarrow g_{1,n}\in\sqrt{S_1^n}$ (проверяется подстановкой найденных значений в $g_{1,n}$).  Таким образом решений глубины 1 тоже нет.

Переходим к поиску решений глубины 3. Рассмотрим $$g_{2,n}=C_n^2(S_f)^{(2)}+C_n^1\left(\frac{\partial
f}{\partial
y}\right)^{(1)}=C_n^2(2y_3+2by^4y_3+8by_1^2y^4)+C_n^1(12by^2y_1^3+8by^3y_1y_2).$$
Если мы подставим сюда найденные нами точки, то получим, что
$\psi(g_{2,n},{V}_{2,i}^4)= 1 <4\Leftrightarrow [f]+(S_f)\not=(1).$


\end{example}

\begin{example}
Дан многочлен $f=(y_2-\frac{49}{3})^2-\frac{49}{3}y_1+y$.
\\
$S_f=2(y_2-\frac{49}{3})$;
\\
$f^{(1)}=2(y_2-\frac{49}{3})y_3-\frac{49}{3}y_2+y_1$;
\\
$f^{(2)}=2(y_2-\frac{49}{3})y_4+(2y_3-\frac{49}{3})y_3+y_2$;
\\
$(S_f)^{(1)}=2y_3$;

Решая систему $f=f^{(1)}=f^{(2)}=S_f=(S_f)^{(1)}=0$ приходим к тому,
что она не совместна, следовательно $[f,S_f]=(1)$ и  для нашего
уравнения $p=1,w=2\ord{h}=2,\ord{f}=2$, т.е. $n$  можно брать начиная с $3$. Построим ${V}_{1,i}^3$ для нашего случая. После вычислений получаем: 
\begin{gather*}
\Pi_{4}({V}_{1,1}^3)=\left(\frac{117649}{27},\frac{2401}{9},\frac{49}{3},7,\frac{-3}{11}\right),
\Pi_{4}({V}_{1,2}^3)=\left(\frac{117649}{27},\frac{2401}{9},\frac{49}{3},\frac{7}{6},\frac{1}{8}\right)
\end{gather*}

Ищем решение глубины 1. Мы знаем, что $g_{1,n}=2ny_3-\frac{49}{3}$, тогда $\psi(g_{1,n},\Pi_{4}({V}_{1,1}^3))=-\infty$, а $\psi(g_{1,n},\Pi_{4}({V}_{1,2}^3))=7$. Отсюда следует, что $[f]+(S_f)\not=(1)$. Отметим, что точка $\left(\frac{117649}{27},\frac{2401}{9},\frac{49}{3},\frac{7}{6},\frac{1}{8}\right)$ не продолжается до решения.  А так как продолжение первой точки происходит однозначно и единственно, то это значит что идеал $[f]+S_f$ максимальный и не равен единичному.


\end{example}



\begin{example}
Даны два многочлена $f= -y_1^2+y_1^2y+yy_1+1$ и $h_1=y_0^2-y_2,h_2=2y_0y_1(y_0-1)+y_2$. Мы хотим установить идеал $[f]+(h_1,h_2)\subseteq K\{y\}$ единичный или нет.

Заметим, что наш многочлен совпадает с многочленом из примера~\ref{example:first} при $a=b=c=1$. Тогда мы знаем, что $[f,S_f]=1$ и $[f]+(S_f)=1$. Заметим, что $h_1+h_2=y\cdot S_f$. Если $S_f=0$, то решений у системы $f=\ldots=f^{(n)}=\ldots=S_f=0$ нет, следовательно, $y=0$ единственный шанс, чтобы система имела решения. Тогда нам осталось понять, если реения у системы $f=\ldots=f^{(n)}=\ldots=h_1=h_2=y=0$. Также из примера~\ref{example:first} мы знаем, что $p=1,w=2\ord{h}=0,\ord{f}=1$. Начальное $n$ берём равным 3. Подставляя $y=0$ во все уравнения $f=f^{(1)}=f^{(2)}=h_1=h_2=y=0$  мы находим, что $y_2=0,y_1=- 1,y_3=0$, т.е. $\Pi(V^3_{0,1})=(0,-1,0,0)$. Отметим, что так как $g_{0,n}=S_f$  не зависит от $n$ и является тождественной константой не равной 0, то соответственно   точка $(0,-1,0,0)$  продлевается  до решение уравнений $f=\ldots=f^{(n)}=\ldots=h_1=h_2=0$. Причём  из этого следует, что наша система имеет единственное решение и $[f]+(h_1,h_2)\ne (1)$.

\end{example}

\section{Следствия}

\begin{lemma}
Пусть $f\in K\{y\}$, где $k$~--- поле нулевой характеристики, и $\ord f = 1$.
Если в идеале $[f]$ содержится квазилинейный многочлен, то $\left[f,\frac{\partial f}{\partial y_0},\ldots,\frac{\partial f}{\partial y_l}\right]=(1)$.
\end{lemma}

\begin{proof}
Пусть $g\in [f]$~--- квазилинейный многочлен порядка $m$.
Его можно записать в виде $g=\sum\limits_{i=0}^ng_if^{(i)}=g'+y_m$, где $g'$ не зависит от переменных порядка выше, чем $m-1$.
Предположим, что $n<2m-2l$. Тогда будет выполнено, что $2k=2(n+l-m)<n$.
По следствию~\ref{corollary:deriv_equal} и определению обобщённых сепарант мы можем для любого $m-l\leqslant p\leqslant n$  каждый многочлен $f^{(p)}$ представить в виде $f^{(p)}=\sum\limits_{i=0}^{k} S_{f,p,i} \, y_{p+l -i}+ Q$, где $k=p+l-m$, $\ord Q < p+l-k=m$.
Все многочлены $f^{(j)}$, $j<m-l$, не зависят от переменных $y_m$ и старше, следовательно, $\dfrac{\partial f^{(j)}}{\partial y_m}=0$.

$$
1= \frac{\partial g}{\partial y_m}=\sum\limits_{i=0}^{n}\frac{\partial g_i}{\partial y_m}f^{(i)}+\sum\limits_{i=m-l}^{n}\frac{\partial f^{(i)}}{\partial y_m}g_i= \sum\limits_{i=0}^{n}\frac{\partial g_i}{\partial y_m}f^{(i)}+\sum\limits_{i=m-l}^{n}S_{f,i,i+l-m}g_i\in \left[f,\frac{\partial f}{\partial y_0},\ldots,\frac{\partial f}{\partial y_l}\right].
$$

Вторая часть суммы принадлежит идеалу $\left[f,\frac{\partial f}{\partial y_0},\ldots,\frac{\partial f}{\partial y_l}\right]$,
т.~к. $S_{f,n,k}=\sum\limits_{j=0}^{l}C_n^{k - l + j
}\left(\frac{\partial f}{\partial y_j}\right)^{(k - l + j)}$. % по определению $S_{f,n,k}$.

Если $n>2m-2l$, то мы можем продифференцировать $g$ $k$ раз ($k$ определим позже), от этого многочлен не перестанет быть квазилинейным, $m'=m+k$, $n'=n+k$. Возьмём $k$, чтобы выполнялось неравенство $n'<2m'-2l$.

\end{proof}

Заметим, что когда мы решали задачу про равенство $[f]+(h_1,\ldots,h_t)=1$, мы могли выбрать в качестве $ (h_1,\ldots,h_t)=(f)$. Тогда конечно $[f]+(f)=[f]\ne (1)$. Но мы можем определить для этого идеала все обозначения введённые нами в \S3.
%Обозначения в следующей лемме взяты как раз таким путём.

\begin{corollary}
Пусть $f\in K\{y\}$ и $\left[f,\frac{\partial f}{\partial y_0},\ldots,\frac{\partial f}{\partial y_l}\right]=(1)$. Рассмотрим идеал $[f]+(f)=[f]\subseteq K\{y\}$. Предположим, что для некоторого  $n_0\ge\max\{2p+1,l,w\}$  и для любых $k,i$ верно, что 
$$
\psi(g_{k,n},\Pi_{n_0+l}(V^{n_0}_{k,i}))\leqslant n_0+k.
$$ 

Тогда $\sqrt{[f]}\cap K[y_0,\ldots,y_{n_0+l}]=\mathbf{I}(\bigcup\limits_{i,k}(V^{n_0}_{k,i}))$.
\end{corollary}

\begin{proof}
Предположим, что это не так. Тогда существует $g\in \sqrt{[f]}\cap K[y_0,\ldots,y_{n_0+l}]$, который не зануляется на хотя бы одном многообразии $(V^{n_0}_{k_0,i_0}))$. Из этого следует, что из точек  $(V^{n_0}_{k_0,i_0}))$ до решения системы $f=\ldots=f^{(i)}=\ldots=0$ мы можем продлить точки многообразия $U=(V^{n_0}_{k_0,i_0}))\cap \mathbf{V}(g)\subseteq K^{n_0+l+1}$. Но $U$ является многообразием меньшей размерности, чем $(V^{n_0}_{k_0,i_0})$, а это противоречит теореме~\ref{theorem:general th1}.
\end{proof}
\begin{remark}
Это следствие показывает, что с некоторого момента, а именно с $n_0$,  пересечения  радикала идеала $(f,\ldots,f^{(n)})\subseteq K\{y\}$ с кольцом многочленов $K[y_0,\ldots,y_{n_0+l}]$ будет постоянным. Из теоремы Гильберта о базисе мы знаем,  что такой момент должен был наступить, иначе у нас бы была бесконечная возрастающая цепочка идеалов, но мы не могли определить, когда он наступит.  
\end{remark}

\begin{thebibliography}{99}

\bibitem{E. R. Kolchin}
E. R. Kolchin.
\emph{On the Exponents of Differential Ideals.}
The Annals of Mathematics, Second Series, Volume 42, Issue 3 (Jul., 1941), 740--777.

\bibitem{AM}
М. Атья, И. Макдональд.
\emph{Введение в коммутативную алгебру.} М., <<Мир>>, 1972.

\bibitem{Cox}
Д. Кокс, Д. Литтл, Д. О'Ши.
\emph{Идеалы, многообразия и алгоритмы.}
М., <<Мир>>, 2000.
\bibitem{Trushin}
Д. В. Трушин.
\emph{Идеал сепарант в кольце дифференциальных многочленов.}
Фундаментальная и прикладная математика, том 13, вып 1, 215--227 (2007).
\bibitem{Hartshorn}
Р. Хартсхорн.
\emph{Алгебраическая геометрия}
М., <<Мир>>
\bibitem{Ferro Theorem 2}
Carr\`a Ferro G.,
\emph{Diferential Gr\"{o}bner Bases in One Variable and in the Partial Case},
Math. Comput. Modelling, Pergamon Press, vol. 25, 1--10, 1997.
\bibitem{Kolchin 2}
E. R. Kolchin ,
\emph{Differential algebra and algebraic groups}, Academic Press, New York and London, 1973.
\bibitem{Lang}
S. Lang,
\emph{Hilbert's Nullstellensatz in Infinite-Dimensional Space}, American Mathematical Society, vol. 3, No. 3 (Jun., 1952), 407--410
\bibitem{Matsumura}
H. Matsumura.
\emph{Commutative algebra}.
Benjamin/Cummings, 1980.
\end{thebibliography}
\end{document}
\begin{definition}
\end{definition}
